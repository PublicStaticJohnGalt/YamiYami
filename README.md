# YamiYami
Тестовое задание для YamiYami

## Задание 
Нужно реализовать следующий сервис:
1. Symfony.
2. Postgres 13.0.
3. PHP 7.3 и выше.

Используя xml (пример можно взять отсюда http://www.cbr.ru/scripts/XML_daily.asp), в БД должны сохраняться данные о курсах валют. XML должен получаться удаленно. Предположим, что ответ в XML всегда содержит актуальные данные по курсам. Записи должны обновляться каждые 10 минут. Если курс валюты поменялся, то делается новая запись, если нет, то ничего. Если в XML появляется валюта, которой ранее не было, то для неё должны создаваться все необходимые сущности.

Так же у приложения должны быть следующие REST API методы (формат ответа - валидный JSON):
1. Получение списка последних известных курсов валют (аналог http://www.cbr.ru/scripts/XML_daily.asp)
2. Получение статистики изменения курсов за указанный период. Указание периода должно быть не обязательным, в этом случае должна возвращаться вся имеющаяся статистика. Так же должна быть возможность запросить статистику по конкретной валюте.
3. Авторизация в REST API должна осуществляться по токену любым методом на выбор исполнителя.

## Комментарии по реализации
Получение записей из XML добавлено в качестве консольной команды 
```
php bin/console currency:update-rates
```
Соответственно, ее можно повесить, например, на crontab

Эндпоинты основных функций:
GET /api/currency_rates
GET /api/currency_rates_history
  (возможные параметры)
  - char_code (например, USD)
  - dt_from (например, 2021-02-14 23:42:04)
  - dt_to (например, 2021-02-14 23:45:04)

Дальнейшее тестирование проводилось через Postman, но можно и через curl.

Для регистрации пользователя:
```
curl -i -X POST -H 'Content-Type: application/json' -d '{"username": "yami", "password": "yami", "email": "yami@yami.ru"}' http://ИМЯ_ХОСТА/register
```

Для получения токена:
```
curl -i -X POST -H 'Content-Type: application/json' -d '{"username": "yami", "password": "yami"}' http://ИМЯ_ХОСТА/api/login_check
```

Проверка функций с помощью полученного токена:
```
curl -i -X GET -H 'Content-Type: application/json' -H 'Authorization: Bearer ТОКЕН' http://ИМЯ_ХОСТА/api/currency_rates
```
